(this["webpackJsonpmeme-page"]=this["webpackJsonpmeme-page"]||[]).push([[0],{30:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},55:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(2),r=n.n(a),o=n(36),i=n.n(o),s=(n(44),n(5)),l=n(19),u=(n(45),n(8)),d=n.n(u),m=n(15),j=n(24);n(47),n(49),n(60),n(61);j.a.initializeApp({apiKey:"AIzaSyA5kSJGlUmKC9PftAV8LyHcpdjoaOwKbJ8",authDomain:"meme-generator-fe1c4.firebaseapp.com",databaseURL:"https://meme-generator-fe1c4-default-rtdb.europe-west1.firebasedatabase.app",projectId:"meme-generator-fe1c4",storageBucket:"meme-generator-fe1c4.appspot.com",messagingSenderId:"888796383810",appId:"1:888796383810:web:657b8ecffc3740a026fbdb",measurementId:"G-8007NWQCGB"});var b=j.a.auth(),h=j.a.firestore(),g=new j.a.auth.GoogleAuthProvider,p=j.a.messaging(),x=function(){var e=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.serviceWorker.register("service-worker.js");case 2:return n=e.sent,e.abrupt("return",p.getToken({vapidKey:"BNpdLHysckNhcRtEnnUFgjCf8HFXOk5HEZHJq63keVcjKJabtwYF0e8OQWeA_3cc22RV3EKfsMWKu7EHLkV9nGw",serviceWorkerRegistration:n}).then((function(e){e?(console.log("current token for client: ",e),t(!0)):(console.log("No registration token available. Request permission to generate one."),t(!1))})).catch((function(e){console.log("An error occurred while retrieving token. ",e)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=j.a.analytics();f.logEvent("notification_received");var O=Object(a.createContext)({user:null}),v=function(e){var t=e.children,n=Object(a.useState)(null),r=Object(s.a)(n,2),o=r[0],i=r[1];return Object(a.useEffect)((function(){b.onAuthStateChanged((function(e){return i(e)}))}),[]),Object(c.jsx)(O.Provider,{value:{user:o},children:t})},w=function(){var e=[window.innerWidth,window.innerHeight],t=Object(a.useState)(e),n=Object(s.a)(t,2),c=n[0],r=n[1];return Object(a.useEffect)((function(){var e=function(){r([window.innerWidth,window.innerHeight])};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),c},k=n(17),S=(n(55),[{icon:"home",name:"Home",path:"/",exact:!0},{icon:"trophy",name:"Top Memes",path:"/topmemes"},{icon:"hammer",name:"Generator",path:"/generator"}]),N=function(){var e=Object(a.useContext)(O).user,t=w(),n=Object(s.a)(t,2),r=n[0],o=(n[1],S.map((function(e){return r>1024?Object(c.jsx)("li",{className:"nav-list",children:Object(c.jsxs)(l.b,{to:e.path,exact:!!e.exact&&e.exact,children:[Object(c.jsx)(k.a,{icon:e.icon})," ",e.name]})},e.name):r<=1024?Object(c.jsx)("li",{className:"nav-list",children:Object(c.jsx)(l.b,{to:e.path,exact:!!e.exact&&e.exact,children:Object(c.jsx)(k.a,{icon:e.icon})})},e.name):void 0})));return Object(c.jsxs)("header",{children:[Object(c.jsx)("button",{className:"log",onClick:function(){e?b.signOut():b.signInWithPopup(g)},children:e?Object(c.jsx)(k.a,{icon:"sign-out-alt"}):Object(c.jsx)(k.a,{icon:"sign-in-alt"})}),Object(c.jsx)("h1",{className:"logo",children:"MemeGen"}),Object(c.jsx)("nav",{className:"main",children:Object(c.jsxs)("ul",{className:"nav-ul",children:[o,e?r>1024?Object(c.jsx)("li",{className:"nav-list",children:Object(c.jsxs)(l.b,{to:"/profile",exact:!1,children:[Object(c.jsx)(k.a,{icon:"user"})," User Profile"]})},"profile"):Object(c.jsx)("li",{className:"nav-list",children:Object(c.jsx)(l.b,{to:"/profile",exact:!1,children:Object(c.jsx)(k.a,{icon:"user"})})},"profile"):null]})})]})},y=n(7),C=n(26),E=(n(58),function(e){var t=e.title,n=e.upperValue,a=e.bottomValue,r=e.textSize,o=e.handleChange;return Object(c.jsxs)("form",{children:[Object(c.jsx)("label",{children:"Name your meme:"}),Object(c.jsx)("input",{type:"text",className:"input-title",name:"title",placeholder:"Title...",value:t,onChange:o}),Object(c.jsx)("label",{className:"text-label",children:"Add text: "}),Object(c.jsx)("input",{className:"text-input",type:"text",name:"upperText",placeholder:"Upper Text",value:n,onChange:o}),Object(c.jsx)("input",{className:"text-input",type:"text",name:"bottomText",placeholder:"Bottom Text",value:a,onChange:o}),Object(c.jsx)("label",{className:"text-label",children:"Font Size: "}),Object(c.jsx)("input",{className:"input-fz",type:"number",name:"textSize",placeholder:"Select font size",value:r,onChange:o})]})}),I=function(e){var t=e.selectedImage,n=e.width,r=e.height,o=e.exitGen,i=Object(a.useContext)(O).user,l=Object(a.useState)(""),u=Object(s.a)(l,2),d=u[0],m=u[1],j=Object(a.useState)(""),b=Object(s.a)(j,2),g=b[0],p=b[1],x=Object(a.useState)(""),f=Object(s.a)(x,2),v=f[0],w=f[1],k=Object(a.useState)(50),S=Object(s.a)(k,2),N=S[0],y=S[1],I=Object(a.useState)("50%"),M=Object(s.a)(I,2),A=M[0],P=M[1],T=Object(a.useState)("10%"),R=Object(s.a)(T,2),L=R[0],z=R[1],F=Object(a.useState)("50%"),B=Object(s.a)(F,2),W=B[0],U=B[1],H=Object(a.useState)("90%"),q=Object(s.a)(H,2),G=q[0],D=q[1],V=Object(a.useState)(!1),K=Object(s.a)(V,2),J=K[0],Y=K[1],_=Object(a.useCallback)((function(e){if(J){var t=document.getElementById("svgImage").getBoundingClientRect(),n=e.clientX-t.left,c=e.clientY-t.top;"uppertxt"===e.target.id?(P("".concat(n,"px")),z("".concat(c,"px"))):"bottomtxt"===e.target.id&&(U("".concat(n,"px")),D("".concat(c,"px")))}}),[J]),X=Object(a.useCallback)((function(){Y(!0)}),[]),Q=Object(a.useCallback)((function(){Y(!1)}),[]),Z=function(e,t){if("download"===e){var n=document.createElement("a");n.download="meme.png",n.href=t,document.body.appendChild(n),n.click()}else if("post"===e){var c=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length,c=0;c<n;c++)e+=t.charAt(Math.floor(Math.random()*n));return e}(),a={index:c,date:new Date,title:d,creator:i.uid,url:t,likes:[]};""===d?alert("You should add the title"):(h.collection("memes").doc("".concat(c)).set(a),alert("Meme posted :)"),m(""),p(""),w(""))}},$=function(e){var t=e.target.id,n=document.getElementById("createdMeme"),c=(new XMLSerializer).serializeToString(n),a=document.createElement("canvas");a.setAttribute("id","canvas");var r=n.getBoundingClientRect(),o=700/(r.width/r.height);a.width=700,a.height=o;var i=document.createElement("img");i.setAttribute("src","data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(c)))),i.onload=function(){a.getContext("2d").drawImage(i,0,0);var e=a.toDataURL("image/png");Z(t,e)}},ee={fontFamily:"Impact",textTransform:"uppercase",fill:"#FFF",stroke:"#000",userSelect:"none"};return Object(c.jsx)("div",{className:"blur",children:Object(c.jsxs)("div",{className:"memegen",children:[Object(c.jsx)("div",{className:"exit",onClick:o,children:"X"}),Object(c.jsx)(E,{title:d,upperValue:v,bottomValue:g,textSize:N,handleChange:function(e){var t=e.target,n=t.name,c=t.value;switch(n){case"upperText":w(c);break;case"bottomText":p(c);break;case"textSize":y(c);break;case"title":m(c);break;default:alert("Sorry, ".concat(n," does not exist. Report this to us and we will check what happened."))}}}),Object(c.jsxs)("svg",{id:"createdMeme",width:n,height:r,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[Object(c.jsx)("image",{id:"svgImage",xlinkHref:t,height:r,width:n}),Object(c.jsx)("text",{id:"uppertxt",style:Object(C.a)(Object(C.a)({},ee),{},{fontSize:"".concat(N,"px")}),x:A,y:L,dominantBaseline:"middle",textAnchor:"middle",onMouseDown:X,onMouseMove:_,onMouseUp:Q,onTouchStart:X,onTouchMove:_,onTouchEnd:Q,children:v}),Object(c.jsx)("text",{id:"bottomtxt",style:Object(C.a)(Object(C.a)({},ee),{},{fontSize:"".concat(N,"px")}),x:W,y:G,dominantBaseline:"middle",textAnchor:"middle",onMouseDown:X,onMouseMove:_,onMouseUp:Q,onTouchStart:X,onTouchMove:_,onTouchEnd:Q,children:g})]}),Object(c.jsxs)("div",{className:"download-post",children:[Object(c.jsx)("button",{id:"download",onClick:$,children:"Download Meme"}),i?Object(c.jsx)("button",{id:"post",onClick:$,children:"Post Meme"}):null]})]})})},M=function(e){var t=e.allMemeImg,n=e.selectImg,a=w(),r=Object(s.a)(a,2),o=r[0],i=(r[1],function(e){return o>600?{width:"20vw",height:"15vw",margin:"0 auto",backgroundImage:"url(".concat(e.url,")"),backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundClip:"content-box",backgroundSize:"cover",border:"1px solid #ddd",borderRadius:"2%"}:o<600&&o>380?{width:"40vw",height:"19vw",margin:"0 auto",backgroundImage:"url(".concat(e.url,")"),backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundClip:"content-box",backgroundSize:"cover",border:"1px solid #ddd",borderRadius:"2%"}:{width:"85vw",height:"30vw",margin:"0 auto",backgroundImage:"url(".concat(e.url,")"),backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundClip:"content-box",backgroundSize:"cover",border:"1px solid #ddd",borderRadius:"2%"}}),l=t.map((function(e){return Object(c.jsxs)("div",{className:"gallery-element",onClick:n,"data-url":e.url,children:[Object(c.jsx)("div",{className:"element-image",style:i(e),"data-url":e.url}),Object(c.jsx)("p",{className:"element-title","data-url":e.url,children:e.name})]},e.id)}));return Object(c.jsxs)("div",{className:"gallery-container",children:[Object(c.jsx)("p",{className:"gen-info",children:"Select image to create meme:"}),Object(c.jsx)("div",{className:"gallery",children:t.length>0?l:Object(c.jsx)("span",{children:"Something is wrong..."})})]})},A=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),i=Object(s.a)(o,2),l=i[0],u=i[1],d=Object(a.useState)(""),m=Object(s.a)(d,2),j=m[0],b=m[1],h=Object(a.useState)(""),g=Object(s.a)(h,2),p=g[0],x=g[1],O=Object(a.useState)(""),v=Object(s.a)(O,2),k=v[0],S=v[1],N=w(),y=Object(s.a)(N,2),C=y[0];y[1];Object(a.useEffect)((function(){f.logEvent("generator_visited"),fetch("https://api.imgflip.com/get_memes").then((function(e){return e.json()})).then((function(e){var t=e.data.memes;u(t)}))}),[]);return Object(c.jsxs)("div",{className:"maingen",children:[Object(c.jsx)(M,{allMemeImg:l,selectImg:function(e){C<1025&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(document.documentElement.requestFullscreen?document.querySelector(".App").requestFullscreen():document.documentElement.webkitRequestFullScreen&&document.querySelector(".App").webkitRequestFullScreen(),window.screen.orientation.lock("landscape-primary"));var t=e.target.dataset.url,n=document.createElement("canvas"),c=new Image;c.src=t,c.crossOrigin="anonymous",c.onload=function(){var e=c.width/c.height;n.width=700,n.height=n.width/e,n.getContext("2d").drawImage(c,0,0,n.width,n.height);var t=n.toDataURL("image/png");r(t),x("".concat(n.width,"px")),S("".concat(n.height,"px")),b(!0),document.querySelector("header").classList.add("blured"),document.querySelector(".gallery-container").classList.add("blured")}}}),j&&n&&k?Object(c.jsx)(I,{selectedImage:n,width:p,height:k,exitGen:function(){b(!1),document.querySelector("header").classList.remove("blured"),document.querySelector(".gallery-container").classList.remove("blured"),C<1025&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&window.screen.orientation.unlock()}}):null]})},P=n(38),T=function(e){var t=e.meme,n=Object(a.useContext)(O).user,r=Object(a.useState)([]),o=Object(s.a)(r,2),i=o[0],l=o[1];Object(a.useEffect)((function(){Object(m.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.collection("memes").doc("".concat(t.index)).get();case 2:n=e.sent,l(n.data().likes);case 4:case"end":return e.stop()}}),e)})))()}),[t.index]);return Object(c.jsxs)("div",{className:"likes",children:[Object(c.jsx)("span",{className:"like-num",children:i.length}),Object(c.jsx)("button",{className:"plus",id:t.index,onClick:function(e){var t=e.target.id;console.log(e);var c=h.collection("memes").doc("".concat(t)),a=[];if(!n)return alert("You have to log in!");a=i.includes(n.uid)?i.filter((function(e){return e!==n.uid})):[].concat(Object(P.a)(i),[n.uid]),Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.update({likes:a});case 2:return e.next=4,c.get();case 4:t=e.sent,l(t.data().likes);case 6:case"end":return e.stop()}}),e)})))()},children:Object(c.jsx)(k.a,{className:"thumbup",icon:"thumbs-up"})})]})},R=(n(30),function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1];Object(a.useEffect)((function(){f.logEvent("homepage_visited"),Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.collection("memes").get();case 2:t=e.sent,r(t.docs.map((function(e){return e.data()})));case 4:case"end":return e.stop()}}),e)})))()}),[]),n.length>=2&&n.sort((function(e,t){return e.date<t.date?1:e.date>t.date?-1:0}));var o=n.map((function(e){return Object(c.jsxs)("div",{className:"memeContainer",id:e.index,children:[Object(c.jsx)("p",{className:"title",children:e.title}),Object(c.jsx)(T,{meme:e}),Object(c.jsx)("img",{className:"memeimg",src:e.url,alt:"meme"}),Object(c.jsxs)("p",{className:"creator",children:["Posted by: ",Object(c.jsx)("span",{children:e.creator})]})]},e.index)}));return Object(c.jsx)("div",{className:"HomePage",children:n.length>0?o:Object(c.jsx)("p",{children:"Loading..."})})}),L=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1],o=b.currentUser;Object(a.useEffect)((function(){f.logEvent("userpage_visited"),Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.collection("memes").get();case 2:t=e.sent,r(t.docs.map((function(e){return e.data()})));case 4:case"end":return e.stop()}}),e)})))()}),[]),n.length>=2&&n.sort((function(e,t){return e.date<t.date?1:e.date>t.date?-1:0}));var i=function(e){var t=e.target.id;!0===window.confirm("Are you sure?")&&h.collection("memes").doc("".concat(t)).delete().then(Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.collection("memes").get();case 2:t=e.sent,r(t.docs.map((function(e){return e.data()})));case 4:case"end":return e.stop()}}),e)}))))},l=n.filter((function(e){return e.creator===o.uid?e:null})).map((function(e){return Object(c.jsxs)("div",{className:"memeContainer",id:e.index,children:[Object(c.jsx)("p",{className:"title",children:e.title}),Object(c.jsx)("div",{className:"likes",children:Object(c.jsx)("span",{className:"like-num",children:e.likes.length})}),Object(c.jsx)("img",{className:"memeimg",src:e.url,alt:"meme"}),Object(c.jsxs)("p",{className:"creator",children:["Posted by: ",Object(c.jsx)("span",{children:e.creator})]}),Object(c.jsx)("button",{className:"plus",id:e.index,onClick:i,children:Object(c.jsx)(k.a,{className:"thumbup",icon:"trash-alt"})})]},e.index)}));return Object(c.jsxs)("div",{className:"HomePage",children:[Object(c.jsx)("h4",{children:"Your created memes:"}),n.length>0?l:Object(c.jsx)("p",{children:"You have no memes..."})]})},z=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1];Object(a.useEffect)((function(){f.logEvent("toppage_visited"),Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.collection("memes").get();case 2:t=e.sent,r(t.docs.map((function(e){return e.data()})));case 4:case"end":return e.stop()}}),e)})))()}),[]),n.length>=2&&n.sort((function(e,t){return e.likes.length<t.likes.length?1:e.likes.length>t.likes.length?-1:0}));var o=n.slice(0,5).map((function(e){return Object(c.jsxs)("div",{className:"memeContainer",id:e.index,children:[Object(c.jsx)("p",{className:"title",children:e.title}),Object(c.jsx)(T,{meme:e}),Object(c.jsx)("img",{className:"memeimg",src:e.url,alt:"meme"}),Object(c.jsxs)("p",{className:"creator",children:["Posted by: ",Object(c.jsx)("span",{children:e.creator})]})]},e.index)}));return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("div",{className:"HomePage",children:n.length>0?o:Object(c.jsx)("p",{children:"Loading..."})})})},F=function(){var e=Object(a.useContext)(O).user;return Object(c.jsxs)(y.c,{children:[Object(c.jsx)(y.a,{exact:!0,path:"/",component:R}),Object(c.jsx)(y.a,{path:"/topmemes",component:z}),Object(c.jsx)(y.a,{path:"/generator",component:A}),e?Object(c.jsx)(y.a,{path:"/profile",component:L}):null,Object(c.jsx)(y.a,{render:function(){return Object(c.jsx)("h2",{children:"Strona nie istnieje..."})}})]})},B=n.p+"static/media/loading.3920eac7.gif",W=function(){return Object(c.jsx)("div",{style:{backgroundColor:"#444",width:"100%",height:"100vh"},children:Object(c.jsx)("img",{src:B,alt:"splash-screen",style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})})},U=function(){var e=Object(a.useState)(!0),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!1),i=Object(s.a)(o,2),u=i[0],d=i[1];return console.log(u),Object(a.useEffect)((function(){setTimeout((function(){r(!1)}),2e3),x(d)}),[]),Object(c.jsx)(c.Fragment,{children:n?Object(c.jsx)(W,{}):Object(c.jsx)(v,{children:Object(c.jsx)(l.a,{basename:"/meme-generator",children:Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)(N,{}),Object(c.jsx)(F,{})]})})})})},H=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function q(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,62)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))},D=n(22),V=n(18);D.b.add(V.b,V.h,V.a,V.g,V.e,V.c,V.d,V.f),i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(U,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/meme-generator",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/meme-generator","/service-worker.js");H?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):q(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):q(t,e)}))}}(),G()}},[[59,1,2]]]);
//# sourceMappingURL=main.b1e28169.chunk.js.map